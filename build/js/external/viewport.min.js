!function(t,e){"function"==typeof define?define("viewport",function(){return e(t)}):t.viewport=e(t)}(this,function(){var t=function(e){return t.prototype.instance&&t.prototype.instance instanceof t?t.prototype.instance:(this.options=this.extend(this.defaults,e||{}),void this._init())};return function(){var e=navigator.userAgent,i=e.match(/(Android);?[\s\/]+([\d.]+)?/),n=e.match(/(iPad).*OS\s([\d_]+)/),o=e.match(/(iPod)(.*OS\s([\d_]+))?/),r=!n&&e.match(/(iPhone\sOS)\s([\d_]+)/),a={};i&&(a.android=!0,a.version=i[2]),r&&!o&&(a.ios=a.iphone=!0,a.version=r[2].replace(/_/g,".")),n&&(a.ios=a.ipad=!0,a.version=n[2].replace(/_/g,".")),o&&(a.ios=a.ipod=!0,a.version=o[3]?o[3].replace(/_/g,"."):null),a.windows=/windows/i.test(e),a.windowsPhone=a.windows&&/phone/i.test(e),a.windowsTablet=a.windows&&/touch/i.test(e)&&!a.windowsPhone,a.tablet=a.android&&!/mobile/i.test(e)||a.ipad||a.windowsTablet,a.mobile=a.android||a.ios||a.windowsPhone;var s=Object.prototype.toString,c="J_viewport";this.constructor=t,this.defaults={width:640,specialDevices:null,delay:200},this.extend=function(t,e){var i,n,o=Array.prototype.slice.call(arguments,1);"boolean"==typeof t&&(i=t,t=o.shift()),n=o.length;for(var r=0;n>r;r++){e=o[r];for(var a in e)e.hasOwnProperty(a)&&(i&&(this.isArray(e[a])||this.isObject(e[a]))?(this.isArray(e[a])&&!this.isArray(t[a])&&(t[a]=[]),this.isObject(e[a])&&!this.isObject(t[a])&&(t[a]={}),this.extend(t[a],e[a],i)):void 0!==e[a]&&(t[a]=e[a]))}return t},this.isArray=Array.isArray||function(t){return"[object Array]"===s.call(t)},this.isObject=function(t){return"[object Function]"===s.call(t)||"[object Object]"===s.call(t)},this._init=function(){{var t,e=this;e.options}a.mobile&&(a.android&&e.handleOrientationChange(),!e.setSpecialDevices()&&e.setViewportByScale(t=e.getViewportScale()))},this.createViewportElement=function(t){var e=document.createElement("meta");return e.id=c,e.name="viewport",t&&(e.content=t),document.getElementsByTagName("head")[0].appendChild(e),e},this.setViewportValue=function(t){var e=document.getElementById(c);return e?e.setAttribute("content",t):e=this.createViewportElement(t),this},this.setSpecialDevices=function(){var t=this,i=t.options,n=i.specialDevices;if(n&&t.isArray(n))for(var o=0,r=n.length;r>o;o++)if(n[o].pattern&&"[object RegExp]"===s.call(n[o].pattern)&&n[o].pattern.test(e))return n[o].dpi&&t.setViewportByDPI(n[o].dpi),n[o].scale&&t.setViewportByScale(n[o].scale),!0;return!1},this.getDeviceWidth=function(){var t=this,e=(t.options,window.innerWidth,window.outerWidth),i=window.screen.width,n=(window.screen.availWidth,Math.max(e,i));return a.android&&parseInt(a.version)<4&&(n=e>i?Math.max(e,i):Math.min(e,i)),n},this.getOrientation=function(){var t;return t=90==window.orientation||-90==window.orientation?1:window.orientation?0:t},this.handleOrientationChange=function(){function t(){var t=i.getOrientation();t!==o&&(e&&clearTimeout(e),e=setTimeout(function(){i.setViewportByScale(scale=i.getViewportScale()),o=0===t?0:1},n.delay))}var e,i=this,n=i.options,o=-1;window.addEventListener("onorientationchange"in window?"orientationchange":"resize",t,!1)},this.getViewportScale=function(){var t,e=this,i=e.options;return t=(e.getDeviceWidth()||i.width)/i.width},this.setViewportByScale=function(t){var i=this,n=i.options;return i.setViewportValue(a.tablet?"width=device-width,user-scalable=no":a.android&&/WebKit/i.test(e)?"width="+n.width+",target-densitydpi=device-dpi,initial-scale="+t+",maximum-scale="+t+",minimum-scale="+t:a.ios?"width="+n.width+",user-scalable=no":"width="+n.width),i}}.call(t.prototype),t.prototype.instance=new t,t.prototype.instance});